#include "ebnn.h"
float l_conv_pool_bn_bst0_bconv_b[10] = {0.010969462,-0.0053916327,0.0021441032,-0.034626134,0.00099476671,0.0090170391,0.021935012,-0.0014137456,-0.0020212219,0.010194763};
uint8_t l_conv_pool_bn_bst0_bconv_W[20] = {63,127,206,127,37,255,65,127,107,255,11,127,228,127,19,255,80,255,232,127};
float l_conv_pool_bn_bst0_bn_beta[10] = {-0.22248448,-0.02095449,-0.51094222,0.65627676,-0.68292922,-0.50151008,-0.44642577,-0.40362993,-0.27636874,-0.37008703};
float l_conv_pool_bn_bst0_bn_gamma[10] = {0.74908417,1.0157775,0.98757297,1.1272507,1.0352865,0.88803124,1.0987618,0.89782035,0.4614504,1.0647504};
float l_conv_pool_bn_bst0_bn_mean[10] = {1.6176391,0.821594,0.92276615,-0.10924186,1.7012256,0.19860415,0.71845776,0.81924391,0.15715989,0.57212055};
float l_conv_pool_bn_bst0_bn_std[10] = {1.5088025,0.8397879,1.0841627,0.31435576,1.6098651,0.45953584,0.92311209,0.99734408,0.3660481,0.81671977};
void l_conv_pool_bn_bst0(float* input, uint8_t* output){
  fconv_layer(input, l_conv_pool_bn_bst0_bconv_W, output, l_conv_pool_bn_bst0_bconv_b, l_conv_pool_bn_bst0_bn_gamma, l_conv_pool_bn_bst0_bn_beta, l_conv_pool_bn_bst0_bn_mean, l_conv_pool_bn_bst0_bn_std, 1, 10, 28, 28, 1, 3, 3, 2, 2, 0, 0, 3, 3, 2, 2, 0, 0);
}

float l_b_linear_bn_softmax1_bl_b[10] = {-0.00099932787,0.00047373748,-0.0015753148,0.0002408111,0.00019218915,-0.0016019841,-0.0014682617,0.00024055672,-0.00083567016,0.0085927909};
uint8_t l_b_linear_bn_softmax1_bl_W[450] = {26,238,51,136,90,118,45,150,205,43,158,247,223,11,225,178,235,255,56,222,123,204,122,95,64,3,5,128,97,129,199,249,151,68,3,14,26,12,39,56,43,48,48,16,254,190,64,41,2,0,64,0,69,113,184,42,9,37,136,0,162,255,26,237,65,109,5,171,192,1,4,144,66,0,0,130,133,128,68,13,70,142,41,0,194,88,33,11,36,50,63,0,61,255,55,141,138,205,251,162,33,188,226,7,153,119,113,186,211,144,182,241,0,198,209,209,231,123,239,1,189,181,222,195,209,211,129,5,251,212,150,28,241,19,255,123,15,140,139,238,58,154,120,190,194,99,35,159,66,33,234,207,110,226,99,128,141,239,52,203,255,56,251,138,30,211,199,92,123,127,56,66,135,224,159,235,56,253,239,182,190,60,155,52,16,59,43,176,1,254,247,245,18,231,15,126,63,151,38,247,146,17,207,253,36,252,113,208,0,63,156,126,249,160,232,39,221,118,195,192,28,33,3,254,7,12,116,68,95,176,3,32,192,91,98,4,32,136,57,166,157,255,152,207,150,0,152,176,249,61,255,126,0,125,252,229,214,69,63,127,25,156,48,32,217,217,7,31,207,63,220,133,71,24,71,240,100,115,252,95,197,61,108,12,47,63,68,64,127,45,95,108,6,96,94,107,48,12,48,227,248,240,96,92,107,160,254,231,141,158,129,247,26,3,222,3,229,179,83,132,123,251,48,252,67,1,38,86,208,125,245,238,40,18,32,179,31,10,63,134,55,40,191,143,144,202,12,63,134,48,2,145,19,61,43,247,243,243,51,160,59,217,237,100,119,198,191,231,14,51,241,216,111,112,120,139,56,1,41,153,204,228,117,135,116,113,140,152,110,239,17,193,78,240,227,28,31,112,211,224,114,4,79,48,46,192,203,206,34,54,110,124,224,33,1,142,149,19,246,9,130,151,92,221,207,199,21,160,134,73,131,83,238,225,188,96,63,7,127,196,67,177,204,4,187,151,254,17,199,0};
float l_b_linear_bn_softmax1_bn_beta[10] = {-0.04124181,-0.14196837,0.043392304,0.12877451,-0.0073199417,-0.066414014,-0.13076366,0.079958588,0.067433126,0.039952118};
float l_b_linear_bn_softmax1_bn_gamma[10] = {1.8401953,1.8893547,1.9202358,1.797209,1.8840009,1.8231608,1.9022801,1.8920991,1.7995409,1.8413905};
float l_b_linear_bn_softmax1_bn_mean[10] = {39.421291,11.51943,2.8971286,-13.499336,2.2780154,9.227313,2.7321074,3.6593931,18.550982,21.172157};
float l_b_linear_bn_softmax1_bn_std[10] = {28.057615,33.801834,26.599474,26.27228,23.858351,24.092447,26.856344,26.940443,20.876703,24.904404};
void l_b_linear_bn_softmax1(uint8_t* input, uint8_t* output){
  blinear_sm_layer(input, l_b_linear_bn_softmax1_bl_W, output, l_b_linear_bn_softmax1_bl_b, l_b_linear_bn_softmax1_bn_gamma, l_b_linear_bn_softmax1_bn_beta, l_b_linear_bn_softmax1_bn_mean, l_b_linear_bn_softmax1_bn_std, 1, 360, 10); 
}


uint8_t temp1[104] = {0};
uint8_t temp2[104] = {0};
void ebnn_compute(float *input, uint8_t *output){
  l_conv_pool_bn_bst0(input, temp1);
  l_b_linear_bn_softmax1(temp1, output);
}
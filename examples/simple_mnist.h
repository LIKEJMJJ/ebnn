#include "ebnn.h"
float l_conv_pool_bn_bst0_bconv_b[10] = {-0.0064935298,0.03442077,-0.039857972,0.01881207,0.033708129,0.17577693,0.18823127,-0.087215327,0.067196205,0.043086946};
uint8_t l_conv_pool_bn_bst0_bconv_W[20] = {37,255,155,255,236,255,236,127,15,255,96,127,16,127,63,127,3,255,210,127};
float l_conv_pool_bn_bst0_bn_beta[10] = {-0.70161134,-0.92779297,-1.1485637,-0.43524522,-0.30001673,0.039005298,0.69342506,-0.8227464,-0.42634168,-1.2171204};
float l_conv_pool_bn_bst0_bn_gamma[10] = {1.1565732,1.1792716,1.3497585,0.93128175,0.78417313,0.43056649,1.3056711,1.3287021,0.86591357,1.6059836};
float l_conv_pool_bn_bst0_bn_mean[10] = {1.1169301,1.7461178,1.7276201,1.0174412,1.4146253,0.28557944,0.085497871,1.7960914,0.56824702,1.1138771};
float l_conv_pool_bn_bst0_bn_std[10] = {1.2702516,1.6234494,1.694409,1.1786162,1.4106439,0.45962784,0.41953239,1.7341632,0.7544986,1.2473239};
void l_conv_pool_bn_bst0(float* input, uint8_t* output){
  fconv_layer(input, l_conv_pool_bn_bst0_bconv_W, output, l_conv_pool_bn_bst0_bconv_b, l_conv_pool_bn_bst0_bn_gamma, l_conv_pool_bn_bst0_bn_beta, l_conv_pool_bn_bst0_bn_mean, l_conv_pool_bn_bst0_bn_std, 1, 10, 28, 28, 1, 3, 3, 2, 2, 0, 0, 3, 3, 2, 2, 0, 0);
}

float l_b_linear_bn_softmax1_bl_b[10] = {-0.018614413,0.0081590032,-0.0019774823,-0.0040185158,0.00089914288,-0.073476739,-0.0084168548,-0.03270461,-0.0005777395,-0.036750395};
uint8_t l_b_linear_bn_softmax1_bl_W[450] = {98,63,247,127,3,199,76,150,56,56,249,193,199,201,6,24,16,188,14,140,2,24,56,0,16,22,92,248,19,38,156,182,36,99,61,213,142,116,4,48,160,3,119,150,209,124,123,76,167,159,229,20,17,103,226,129,97,17,240,32,38,1,115,148,10,17,235,8,33,2,0,111,166,123,172,247,232,197,66,22,58,172,6,16,204,35,35,221,81,90,160,225,254,226,15,230,2,203,251,255,240,1,125,63,158,240,27,255,227,11,191,238,127,28,240,17,251,255,247,67,27,191,176,7,255,96,226,78,61,28,56,6,14,111,32,98,99,136,157,63,230,11,125,176,255,209,175,179,138,56,184,237,60,250,71,128,219,255,124,235,199,178,99,30,23,244,228,54,188,192,223,227,231,183,243,227,2,30,0,199,31,255,180,80,236,184,41,240,39,19,4,62,88,56,32,3,245,135,230,54,94,33,148,33,5,178,199,255,231,195,126,122,35,109,116,8,108,18,15,131,25,31,252,183,13,68,134,0,157,116,205,123,246,80,25,159,223,37,208,199,63,205,26,108,241,32,233,240,199,31,206,25,116,105,223,241,149,207,0,0,31,44,49,255,249,160,184,32,0,71,255,207,93,104,4,96,4,251,32,4,16,115,115,241,195,24,75,159,220,1,198,30,1,231,26,20,159,145,229,0,2,47,228,112,115,196,64,17,198,18,47,252,245,223,192,129,1,54,51,226,63,204,48,6,223,221,130,0,67,252,241,0,128,131,240,119,83,137,253,243,36,128,128,19,95,124,244,38,95,61,48,235,236,131,3,1,2,31,175,156,32,251,200,110,112,140,112,195,221,4,47,29,63,131,198,110,241,13,145,185,216,136,225,70,239,160,31,252,0,19,140,31,152,28,198,7,58,123,86,16,224,185,253,199,95,1,142,245,27,243,6,47,132,7,0,113,126,194,61,14,51,198,1,27,203,136,35,152,46,3,199,1,135,24,105,123,202,28,184,113,56,17,227,140,99,48,17,239,57,191};
float l_b_linear_bn_softmax1_bn_beta[10] = {-0.34729379,-1.0278741,0.39340433,0.33921546,-0.25618872,0.2925714,-0.69929028,-0.19474472,0.89433187,0.14856137};
float l_b_linear_bn_softmax1_bn_gamma[10] = {3.8606737,3.8480198,3.5188923,3.5685117,3.9184108,3.2130334,4.0912805,4.0434799,2.8145733,3.5629311};
float l_b_linear_bn_softmax1_bn_mean[10] = {32.131268,13.69396,-10.62608,3.7725439,37.213699,24.008619,5.0400825,17.987474,21.911251,50.405525};
float l_b_linear_bn_softmax1_bn_std[10] = {27.809536,30.137859,30.000986,27.059387,29.092751,25.17787,30.757618,30.530537,23.117125,27.250481};
void l_b_linear_bn_softmax1(uint8_t* input, uint8_t* output){
  blinear_sm_layer(input, l_b_linear_bn_softmax1_bl_W, output, l_b_linear_bn_softmax1_bl_b, l_b_linear_bn_softmax1_bn_gamma, l_b_linear_bn_softmax1_bn_beta, l_b_linear_bn_softmax1_bn_mean, l_b_linear_bn_softmax1_bn_std, 1, 360, 10); 
}


uint8_t temp1[104] = {0};
uint8_t temp2[104] = {0};
void ebnn_compute(float *input, uint8_t *output){
  l_conv_pool_bn_bst0(input, temp1);
  l_b_linear_bn_softmax1(temp1, output);
}